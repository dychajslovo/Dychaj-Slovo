<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Potvrdenie objednávky – Dýchaj Slovo</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@600&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Open Sans',sans-serif;margin:40px;background:#f4f4f4;color:#333;text-align:center}
        .c{max-width:700px;margin:40px auto;background:#fff;padding:40px;border-radius:16px;box-shadow:0 6px 16px rgba(0,0,0,.1)}
        h1{font-family:'Fredoka',sans-serif;color:#2c495e;font-size:32px;margin-bottom:15px}
        p{font-size:17px;line-height:1.7;margin:12px 0;color:#444}
        .order-details{background:#f9f9f9;padding:20px;border-radius:10px;margin:25px 0;text-align:left;font-size:15px;line-height:1.6}
        .item{display:flex;align-items:center;gap:12px;margin:8px 0}
        .item img{width:50px;height:50px;object-fit:contain;border-radius:6px}
        .btn-container{display:flex;gap:15px;justify-content:center;margin-top:30px;flex-wrap:wrap}
        .btn{background:#2c495e;color:white;padding:12px 24px;border:none;border-radius:30px;font-size:16px;font-weight:600;cursor:pointer;text-decoration:none;flex:1;max-width:220px}
        .btn:hover{background:#3fcfd5}
        .download-btn{background:#4CAF50}
        .download-btn:hover{background:#45a049}
        @media (max-width:600px){.c{padding:25px}h1{font-size:28px}.btn-container{flex-direction:column}.btn{max-width:none}}
    </style>
</head>
<body>
<div class="c">
    <h1>Ďakujeme za vašu objednávku!</h1>
    <p>Vaša objednávka bola <strong>úspešne prijatá</strong>.</p>
    <p>Platobné údaje vám <strong>zašleme čoskoro na email</strong>.</p>
    <p>Po prijatí platby odošleme tovar <strong>poštou (2–5 dní)</strong>.</p>

    <div class="order-details" id="summary">
        <p>Načítavam detaily objednávky...</p>
    </div>

    <div class="btn-container">
        <button id="downloadBtn" class="btn download-btn" style="display:none">Stiahnuť PDF potvrdenie</button>
        <a href="index.html" class="btn">Späť na hlavnú stránku</a>
    </div>
</div>

<script>
    const orderData = JSON.parse(localStorage.getItem('lastOrder')) || {};
    const pdfDataUrl = localStorage.getItem('orderPDF');

    const downloadBtn = document.getElementById('downloadBtn');

    if (!orderData.orderId || !pdfDataUrl) {
        document.getElementById('summary').innerHTML = '<p>Žiadne detaily objednávky nie sú dostupné.</p>';
    } else {
        let itemsHtml = '';
        orderData.items.forEach(item => {
            itemsHtml += `
                <div class="item">
                    ${item.img ? `<img src="${item.img}" alt="Produkt">` : ''}
                    <div>${item.title} – ${item.price}</div>
                </div>
            `;
        });

        document.getElementById('summary').innerHTML = `
            <strong>Objednávka ${orderData.orderId}</strong><br><br>
            ${itemsHtml}<br>
            <strong>Doprava:</strong> ${orderData.shipping}<br>
            <strong>Celkovo:</strong> ${orderData.total}<br><br>
            <strong>Doručenie na:</strong><br>
            ${orderData.name}<br>
            ${orderData.address}<br>
            ${orderData.email}
        `;

        downloadBtn.style.display = 'block';
        downloadBtn.onclick = () => {
            const link = document.createElement('a');
            link.href = pdfDataUrl;
            link.download = `objednavka_${orderData.orderId.replace('#', '')}.pdf`;
            link.click();
        };

        // Auto-čistenie po 10 minútach
        setTimeout(() => {
            localStorage.removeItem('lastOrder');
            localStorage.removeItem('orderPDF');
        }, 10 * 60 * 1000);
    }
</script>
</body>
</html>
